%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% mrl-preamble-r.tex
%
% This LaTeX file is included in the Rmarkdown preamble.

% Use fancyhdr to redefine plain page style to use sans serif font for page number:
% (this style is applied to the first page)
\usepackage{fancyhdr}
\fancypagestyle{plain}{
  \fancyhf{}
  \renewcommand{\headrulewidth}{0pt}
  \renewcommand{\footrulewidth}{0pt}
  % \fancyfoot[C]{\sffamily\thepage}
}

% Modify fancyhdr's fancy style to be identical; this style is applied to all pages after the first:
% (this style could be easily modified as needed)
\fancyhead{}
\fancyfoot{}
\fancyfoot[C]{\sffamily\thepage}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\pagestyle{fancy}

% Define theme colour:
% \usepackage[dvipsnames]{xcolor}
\definecolor{themecolour}{HTML}{00205B} % Pantone 281C

% Change the title font:
\usepackage{titling}
\pretitle{\begin{center}\Large\sffamily\bfseries\color{themecolour}}
\posttitle{\par\end{center}}
\preauthor{\vspace{2ex}\begin{center}}
\postauthor{\end{center}}
\predate{\begin{center}}
\postdate{\end{center}}

% Adjust paragraph spacing:
\setlength{\parindent}{0em}
\setlength{\parskip}{1ex}

% Format table of contents:
\usepackage[titles]{tocloft}
% Adjust spacing:
\setlength{\cftbeforesecskip}{0pt}
\setlength{\cftsecindent}{0pt}
\setlength{\cftsubsecindent}{0pt}
\setlength{\cftsubsubsecindent}{0pt}
% Adjust fonts:
\renewcommand{\cfttoctitlefont}{\normalsize\rmfamily\bfseries\color{themecolour}}
\renewcommand{\cftsecfont}{\small\rmfamily}
\renewcommand{\cftsecpagefont}{\small\rmfamily}
\renewcommand{\cftsubsecfont}{\small\rmfamily\itshape}
\renewcommand{\cftsubsecpagefont}{\small\rmfamily\itshape}
% Remove dot leaders:
\renewcommand{\cftdot}{}
% Adjust spacing:
\setlength\cftsecnumwidth{1em}
\renewcommand{\cftsecaftersnum}{.}
\renewcommand{\cftsubsecaftersnum}{.}

% Style section headers:
\usepackage{titlesec}
\titleformat{\section}{\large\sffamily\bfseries\color{themecolour}}{\thetitle.}{0.5em}{}
\titlespacing*{\section}{0pt}{\baselineskip}{\parskip}
\titleformat{\subsection}{\normalsize\sffamily\bfseries\color{themecolour}}{\thetitle.}{0.5em}{}
\titlespacing*{\subsection}{0pt}{0.5\baselineskip}{0pt}
\titleformat{\subsubsection}{\normalsize\sffamily\bfseries\itshape\color{themecolour}}{\thetitle.}{0.5em}{}
\titlespacing*{\subsubsection}{0pt}{0.5\baselineskip}{0pt}

% Change font for figure labels:
\usepackage[font=small,
            labelfont={color=themecolour,bf,sf},
            textfont=sf,
            justification=justified,singlelinecheck=false]{caption}
\captionsetup[table]{skip=4pt}

% Change the table font:
\usepackage{etoolbox}
\AtBeginEnvironment{longtable}{\sffamily}
\AtBeginEnvironment{tabular}{\sffamily}
\AtBeginEnvironment{tabularx}{\sffamily}

% Reduce spacing in list environments:
\usepackage{enumitem}
% Indent lists to align with references:
\setlist[enumerate,itemize]{
  left=0pt .. 1.5em,
  topsep=0pt,
  itemsep=0pt,
  parsep=0pt
}

% Add space at beginning of references
\AtBeginEnvironment{CSLReferences}{\vspace{\parskip}}
% Adjust reference indent:
\setlength{\csllabelwidth}{1.5em}

% Prevent figures from floating:
% (from https://stackoverflow.com/questions/16626462/figure-position-in-markdown-when-converting-to-pdf-with-knitr-and-pandoc/33801326#33801326)
\usepackage{float}
\let\origfigure\figure
\let\endorigfigure\endfigure
\renewenvironment{figure}[1][2] {
  % \expandafter\origfigure\expandafter[H]
  \expandafter\origfigure\expandafter[h]
} {
  \endorigfigure
}

% Allow landscape orientation for large plots:
\usepackage{pdflscape}
\newcommand{\blandscape}{\begin{landscape}}
\newcommand{\elandscape}{\end{landscape}}

\usepackage{subfig}

% Increase line spacing
\usepackage{setspace}
% \onehalfspacing

% Remove indent from footnotes:
\usepackage[hang,flushmargin,norule,perpage,symbol*]{footmisc}

% Use sans serif for footnotes:
% This is taken from https://tex.stackexchange.com/questions/393179/bigfoot-make-sans-serif-footnote
\usepackage{bigfoot}
\usepackage{xpatch}
\newfootnote[plain]{default}
\xpatchcmd{\@makefnstartbox}{%
\footnotesize}%
{\footnotesize\sffamily}{}{}
% \xpatchcmd{\@makefnmark}{\normalfont}{\sffamily}{}{}

% Enable hyperlinks for paper URLs:
% \usepackage{hyperref}
% \hypersetup{
%   hyperfootnotes=false,
%   colorlinks=true,
%   citecolor=themecolour,
%   urlcolor=themecolour,
%   linkcolor=.
% }

% Do not put extra space after periods
\frenchspacing

\raggedbottom

\singlespace
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
